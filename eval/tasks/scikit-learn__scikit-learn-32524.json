{
  "id": "scikit-learn__scikit-learn-32524",
  "repo": "scikit-learn/scikit-learn",
  "base_commit": "56c74de012ab2c464824938b455e370fd58a34ed",
  "issue_number": 1234,
  "issue_title": "MRG fix bincount mess I made in kmeans.",
  "issue_body": "This should clean up the stuff I pushed earlier.\ncc @ogrisel @gaelvaroquaux Could you have a brief look? What I pushed earlier is buggy but I didn't dare push again after so many failed fixes.\n",
  "pr_number": 32524,
  "pr_title": "MNT Clean up deprecations for 1.8: base_estimator arg in SelfTrainingClassifier",
  "gold_patch": "diff --git a/sklearn/semi_supervised/_self_training.py b/sklearn/semi_supervised/_self_training.py\nindex 392288cc4ca6f..4b69e3defd405 100644\n--- a/sklearn/semi_supervised/_self_training.py\n+++ b/sklearn/semi_supervised/_self_training.py\n@@ -1,6 +1,5 @@\n import warnings\n from numbers import Integral, Real\n-from warnings import warn\n \n import numpy as np\n \n@@ -12,7 +11,7 @@\n     clone,\n )\n from sklearn.utils import Bunch, get_tags, safe_mask\n-from sklearn.utils._param_validation import HasMethods, Hidden, Interval, StrOptions\n+from sklearn.utils._param_validation import HasMethods, Interval, StrOptions\n from sklearn.utils.metadata_routing import (\n     MetadataRouter,\n     MethodMapping,\n@@ -52,15 +51,6 @@ class SelfTrainingClassifier(ClassifierMixin, MetaEstimatorMixin, BaseEstimator)\n         .. versionadded:: 1.6\n             `estimator` was added to replace `base_estimator`.\n \n-    base_estimator : estimator object\n-        An estimator object implementing `fit` and `predict_proba`.\n-        Invoking the `fit` method will fit a clone of the passed estimator,\n-        which will be stored in the `estimator_` attribute.\n-\n-        .. deprecated:: 1.6\n-            `base_estimator` was deprecated in 1.6 and will be removed in 1.8.\n-            Use `estimator` instead.\n-\n     threshold : float, default=0.75\n         The decision threshold for use with `criterion='threshold'`.\n         Should be in [0, 1). When using the `'threshold'` criterion, a\n@@ -161,13 +151,7 @@ class SelfTrainingClassifier(ClassifierMixin, MetaEstimatorMixin, BaseEstimator)\n     _parameter_constraints: dict = {\n         # We don't require `predic_proba` here to allow passing a meta-estimator\n         # that only exposes `predict_proba` after fitting.\n-        # TODO(1.8) remove None option\n-        \"estimator\": [None, HasMethods([\"fit\"])],\n-        # TODO(1.8) remove\n-        \"base_estimator\": [\n-            HasMethods([\"fit\"]),\n-            Hidden(StrOptions({\"deprecated\"})),\n-        ],\n+        \"estimator\": [HasMethods([\"fit\"])],\n         \"threshold\": [Interval(Real, 0.0, 1.0, closed=\"left\")],\n         \"criterion\": [StrOptions({\"threshold\", \"k_best\"})],\n         \"k_best\": [Interval(Integral, 1, None, closed=\"left\")],\n@@ -178,7 +162,6 @@ class SelfTrainingClassifier(ClassifierMixin, MetaEstimatorMixin, BaseEstimator)\n     def __init__(\n         self,\n         estimator=None,\n-        base_estimator=\"deprecated\",\n         threshold=0.75,\n         criterion=\"threshold\",\n         k_best=10,\n@@ -192,9 +175,6 @@ def __init__(\n         self.max_iter = max_iter\n         self.verbose = verbose\n \n-        # TODO(1.8) remove\n-        self.base_estimator = base_estimator\n-\n     def _get_estimator(self):\n         \"\"\"Get the estimator.\n \n@@ -203,30 +183,7 @@ def _get_estimator(self):\n         estimator_ : estimator object\n             The cloned estimator object.\n         \"\"\"\n-        # TODO(1.8): remove and only keep clone(self.estimator)\n-        if self.estimator is None and self.base_estimator != \"deprecated\":\n-            estimator_ = clone(self.base_estimator)\n-\n-            warn(\n-                (\n-                    \"`base_estimator` has been deprecated in 1.6 and will be removed\"\n-                    \" in 1.8. Please use `estimator` instead.\"\n-                ),\n-                FutureWarning,\n-            )\n-        # TODO(1.8) remove\n-        elif self.estimator is None and self.base_estimator == \"deprecated\":\n-            raise ValueError(\n-                \"You must pass an estimator to SelfTrainingClassifier. Use `estimator`.\"\n-            )\n-        elif self.estimator is not None and self.base_estimator != \"deprecated\":\n-            raise ValueError(\n-                \"You must pass only one estimator to SelfTrainingClassifier.\"\n-                \" Use `estimator`.\"\n-            )\n-        else:\n-            estimator_ = clone(self.estimator)\n-        return estimator_\n+        return clone(self.estimator)\n \n     @_fit_context(\n         # SelfTrainingClassifier.estimator is not validated yet\n@@ -619,7 +576,5 @@ def get_metadata_routing(self):\n \n     def __sklearn_tags__(self):\n         tags = super().__sklearn_tags__()\n-        # TODO(1.8): remove the condition check together with base_estimator\n-        if self.estimator is not None:\n-            tags.input_tags.sparse = get_tags(self.estimator).input_tags.sparse\n+        tags.input_tags.sparse = get_tags(self.estimator).input_tags.sparse\n         return tags\ndiff --git a/sklearn/semi_supervised/tests/test_self_training.py b/sklearn/semi_supervised/tests/test_self_training.py\nindex 9f24ae8a20c56..26b6feff6ab2a 100644\n--- a/sklearn/semi_supervised/tests/test_self_training.py\n+++ b/sklearn/semi_supervised/tests/test_self_training.py\n@@ -350,25 +350,6 @@ def test_self_training_estimator_attribute_error():\n     assert inner_msg in str(exec_info.value.__cause__)\n \n \n-# TODO(1.8): remove in 1.8\n-def test_deprecation_warning_base_estimator():\n-    warn_msg = \"`base_estimator` has been deprecated in 1.6 and will be removed\"\n-    with pytest.warns(FutureWarning, match=warn_msg):\n-        SelfTrainingClassifier(base_estimator=DecisionTreeClassifier()).fit(\n-            X_train, y_train_missing_labels\n-        )\n-\n-    error_msg = \"You must pass an estimator to SelfTrainingClassifier\"\n-    with pytest.raises(ValueError, match=error_msg):\n-        SelfTrainingClassifier().fit(X_train, y_train_missing_labels)\n-\n-    error_msg = \"You must pass only one estimator to SelfTrainingClassifier.\"\n-    with pytest.raises(ValueError, match=error_msg):\n-        SelfTrainingClassifier(\n-            base_estimator=DecisionTreeClassifier(), estimator=DecisionTreeClassifier()\n-        ).fit(X_train, y_train_missing_labels)\n-\n-\n # Metadata routing tests\n # =================================================================\n \n",
  "fail_to_pass": [],
  "pass_to_pass": [],
  "relevant_files": [
    "sklearn/semi_supervised/_self_training.py",
    "sklearn/semi_supervised/tests/test_self_training.py"
  ],
  "difficulty": "medium",
  "created_at": "2025-10-17T11:51:31Z",
  "pr_url": "https://github.com/scikit-learn/scikit-learn/pull/32524",
  "issue_url": "https://github.com/scikit-learn/scikit-learn/pull/1234"
}