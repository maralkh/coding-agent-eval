{
  "id": "scikit-learn__scikit-learn-31873",
  "repo": "scikit-learn/scikit-learn",
  "base_commit": "8525ba5d3c3b5423a5599e654ce73b931882a434",
  "issue_number": 1234,
  "issue_title": "MRG fix bincount mess I made in kmeans.",
  "issue_body": "This should clean up the stuff I pushed earlier.\ncc @ogrisel @gaelvaroquaux Could you have a brief look? What I pushed earlier is buggy but I didn't dare push again after so many failed fixes.\n",
  "pr_number": 31873,
  "pr_title": "ENH/DOC clearer sample weight validation error msg",
  "gold_patch": "diff --git a/doc/whats_new/upcoming_changes/sklearn.utils/31873.enhancement.rst b/doc/whats_new/upcoming_changes/sklearn.utils/31873.enhancement.rst\nnew file mode 100644\nindex 0000000000000..b86d758351daa\n--- /dev/null\n+++ b/doc/whats_new/upcoming_changes/sklearn.utils/31873.enhancement.rst\n@@ -0,0 +1,4 @@\n+``sklearn.utils._check_sample_weight`` now raises a clearer error message when the\n+provided weights are neither a scalar nor a 1-D array-like of the same size as the\n+input data.\n+:issue:`31712` by :user:`Kapil Parekh <kapslock123>`.\ndiff --git a/sklearn/utils/tests/test_validation.py b/sklearn/utils/tests/test_validation.py\nindex adc5d80f591be..dbc9fec7b3ee3 100644\n--- a/sklearn/utils/tests/test_validation.py\n+++ b/sklearn/utils/tests/test_validation.py\n@@ -1608,7 +1608,7 @@ def _check_sample_weight_common(xp):\n     assert_allclose(_convert_to_numpy(sample_weight, xp), 2 * np.ones(5))\n \n     # check wrong number of dimensions\n-    with pytest.raises(ValueError, match=\"Sample weights must be 1D array or scalar\"):\n+    with pytest.raises(ValueError, match=r\"Sample weights must be 1D array or scalar\"):\n         _check_sample_weight(xp.ones((2, 4)), X=xp.ones((2, 2)))\n \n     # check incorrect n_samples\ndiff --git a/sklearn/utils/validation.py b/sklearn/utils/validation.py\nindex 7b2c5efee53de..f1c3d11de13b2 100644\n--- a/sklearn/utils/validation.py\n+++ b/sklearn/utils/validation.py\n@@ -2222,7 +2222,11 @@ def _check_sample_weight(\n             input_name=\"sample_weight\",\n         )\n         if sample_weight.ndim != 1:\n-            raise ValueError(\"Sample weights must be 1D array or scalar\")\n+            raise ValueError(\n+                f\"Sample weights must be 1D array or scalar, got \"\n+                f\"{sample_weight.ndim}D array. Expected either a scalar value \"\n+                f\"or a 1D array of length {n_samples}.\"\n+            )\n \n         if sample_weight.shape != (n_samples,):\n             raise ValueError(\n",
  "fail_to_pass": [],
  "pass_to_pass": [],
  "relevant_files": [
    "sklearn/utils/tests/test_validation.py",
    "sklearn/utils/validation.py"
  ],
  "difficulty": "medium",
  "created_at": "2025-08-03T22:21:45Z",
  "pr_url": "https://github.com/scikit-learn/scikit-learn/pull/31873",
  "issue_url": "https://github.com/scikit-learn/scikit-learn/pull/1234"
}