{
  "id": "scikit-learn__scikit-learn-31266",
  "repo": "scikit-learn/scikit-learn",
  "base_commit": "9ba4f917c340b659c6d28d734c839d76eecf636c",
  "issue_number": 31243,
  "issue_title": "Use more complex data in `test_roc_curve_display.py`",
  "issue_body": "`data_binary` fixture in `test_roc_curve_display.py`, which uses the iris dataset: \n\nhttps://github.com/scikit-learn/scikit-learn/blob/af7df5ced0eb1124df12dd389cc4ef7a9042837e/sklearn/metrics/_plot/tests/test_roc_curve_display.py#L28-L30\n\nalways gives a AUC value of 1.0 (with and without `drop_intermediate`). Should we consider using more complex data?\n\nNoticed in https://github.com/scikit-learn/scikit-learn/pull/30399#discussion_r2055566594\n\ncc @glemaitre",
  "pr_number": 31266,
  "pr_title": "Enhance ROC Curve Display Tests for Improved Clarity and Maintainability",
  "gold_patch": "diff --git a/sklearn/metrics/_plot/tests/test_roc_curve_display.py b/sklearn/metrics/_plot/tests/test_roc_curve_display.py\nindex c2e6c865fa9a9..ca0d7155e7c2c 100644\n--- a/sklearn/metrics/_plot/tests/test_roc_curve_display.py\n+++ b/sklearn/metrics/_plot/tests/test_roc_curve_display.py\n@@ -5,7 +5,7 @@\n \n from sklearn import clone\n from sklearn.compose import make_column_transformer\n-from sklearn.datasets import load_breast_cancer, load_iris\n+from sklearn.datasets import load_breast_cancer, make_classification\n from sklearn.exceptions import NotFittedError\n from sklearn.linear_model import LogisticRegression\n from sklearn.metrics import RocCurveDisplay, auc, roc_curve\n@@ -16,20 +16,19 @@\n \n \n @pytest.fixture(scope=\"module\")\n-def data():\n-    X, y = load_iris(return_X_y=True)\n-    # Avoid introducing test dependencies by mistake.\n-    X.flags.writeable = False\n-    y.flags.writeable = False\n+def data_binary():\n+    X, y = make_classification(\n+        n_samples=200,\n+        n_features=20,\n+        n_informative=5,\n+        n_redundant=2,\n+        flip_y=0.1,\n+        class_sep=0.8,\n+        random_state=42,\n+    )\n     return X, y\n \n \n-@pytest.fixture(scope=\"module\")\n-def data_binary(data):\n-    X, y = data\n-    return X[y < 2], y[y < 2]\n-\n-\n @pytest.mark.parametrize(\"response_method\", [\"predict_proba\", \"decision_function\"])\n @pytest.mark.parametrize(\"with_sample_weight\", [True, False])\n @pytest.mark.parametrize(\"drop_intermediate\", [True, False])\n",
  "fail_to_pass": [],
  "pass_to_pass": [],
  "relevant_files": [
    "sklearn/metrics/_plot/tests/test_roc_curve_display.py"
  ],
  "difficulty": "easy",
  "created_at": "2025-04-28T11:54:35Z",
  "pr_url": "https://github.com/scikit-learn/scikit-learn/pull/31266",
  "issue_url": "https://github.com/scikit-learn/scikit-learn/issues/31243"
}