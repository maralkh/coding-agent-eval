{
  "id": "scikit-learn__scikit-learn-30373",
  "repo": "scikit-learn/scikit-learn",
  "base_commit": "d388d88b936f1c20b70ca466c9c9edd7975cd2a8",
  "issue_number": 29677,
  "issue_title": "API Revamp estimator tags",
  "issue_body": "Closes #22606 \r\nCloses #20804 \r\n\r\nThis PR revamps estimator tags, puts them in dataclasses, and is based on #22606 \r\n\r\nHigh level changes from this PR:\r\n\r\n(from #22606):\r\n- replace MRO mechanism with inheritance\r\n- remove `_get_tags` and `_more_tags` and introduce `__sklearn_tags__`\r\n\r\nthis PR:\r\n- dataclasses are introduced to store the tags, and they're scoped in a few dataclasses. This helps users with auto-complete as well.\r\n- `stateless` is removed and now we only use `requires_fit`. The two were redundant.\r\n- `only_binary` is now replaced with `multi_class`\r\n- `multioutput_only` is removed and now we have `multi_output` and `single_output`\r\n- `get_tags`, `default_tags`, and `Tags` are put into public API",
  "pr_number": 30373,
  "pr_title": "API drop Tags.regressor_tags.multi_label",
  "gold_patch": "diff --git a/sklearn/ensemble/_forest.py b/sklearn/ensemble/_forest.py\nindex a5475eb0e6e62..c396f9344d1d5 100644\n--- a/sklearn/ensemble/_forest.py\n+++ b/sklearn/ensemble/_forest.py\n@@ -1165,11 +1165,6 @@ def _compute_partial_dependence_recursion(self, grid, target_features):\n \n         return averaged_predictions\n \n-    def __sklearn_tags__(self):\n-        tags = super().__sklearn_tags__()\n-        tags.regressor_tags.multi_label = True\n-        return tags\n-\n \n class RandomForestClassifier(ForestClassifier):\n     \"\"\"\ndiff --git a/sklearn/utils/_tags.py b/sklearn/utils/_tags.py\nindex 1ba1913c37234..9fc6e66f9b0fc 100644\n--- a/sklearn/utils/_tags.py\n+++ b/sklearn/utils/_tags.py\n@@ -98,6 +98,8 @@ class TargetTags:\n         Whether a regressor supports multi-target outputs or a classifier supports\n         multi-class multi-output.\n \n+        See :term:`multi-output` in the glossary.\n+\n     single_output : bool, default=True\n         Whether the target can be single-output. This can be ``False`` if the\n         estimator supports only multi-output cases.\n@@ -150,8 +152,13 @@ class ClassifierTags:\n         classification. Therefore this flag indicates whether the\n         classifier is a binary-classifier-only or not.\n \n+        See :term:`multi-class` in the glossary.\n+\n     multi_label : bool, default=False\n-        Whether the classifier supports multi-label output.\n+        Whether the classifier supports multi-label output: a data point can\n+        be predicted to belong to a variable number of classes.\n+\n+        See :term:`multi-label` in the glossary.\n     \"\"\"\n \n     poor_score: bool = False\n@@ -172,13 +179,9 @@ class RegressorTags:\n         n_informative=1, bias=5.0, noise=20, random_state=42)``. The\n         dataset and values are based on current estimators in scikit-learn\n         and might be replaced by something more systematic.\n-\n-    multi_label : bool, default=False\n-        Whether the regressor supports multilabel output.\n     \"\"\"\n \n     poor_score: bool = False\n-    multi_label: bool = False\n \n \n @dataclass(**_dataclass_args())\n@@ -496,7 +499,6 @@ def _to_new_tags(old_tags, estimator=None):\n     if estimator_type == \"regressor\":\n         regressor_tags = RegressorTags(\n             poor_score=old_tags[\"poor_score\"],\n-            multi_label=old_tags[\"multilabel\"],\n         )\n     else:\n         regressor_tags = None\n@@ -520,18 +522,16 @@ def _to_old_tags(new_tags):\n     \"\"\"Utility function convert old tags (dictionary) to new tags (dataclass).\"\"\"\n     if new_tags.classifier_tags:\n         binary_only = not new_tags.classifier_tags.multi_class\n-        multilabel_clf = new_tags.classifier_tags.multi_label\n+        multilabel = new_tags.classifier_tags.multi_label\n         poor_score_clf = new_tags.classifier_tags.poor_score\n     else:\n         binary_only = False\n-        multilabel_clf = False\n+        multilabel = False\n         poor_score_clf = False\n \n     if new_tags.regressor_tags:\n-        multilabel_reg = new_tags.regressor_tags.multi_label\n         poor_score_reg = new_tags.regressor_tags.poor_score\n     else:\n-        multilabel_reg = False\n         poor_score_reg = False\n \n     if new_tags.transformer_tags:\n@@ -543,7 +543,7 @@ def _to_old_tags(new_tags):\n         \"allow_nan\": new_tags.input_tags.allow_nan,\n         \"array_api_support\": new_tags.array_api_support,\n         \"binary_only\": binary_only,\n-        \"multilabel\": multilabel_clf or multilabel_reg,\n+        \"multilabel\": multilabel,\n         \"multioutput\": new_tags.target_tags.multi_output,\n         \"multioutput_only\": (\n             not new_tags.target_tags.single_output and new_tags.target_tags.multi_output\ndiff --git a/sklearn/utils/estimator_checks.py b/sklearn/utils/estimator_checks.py\nindex 6bb6524974a3a..77fb974a96ef1 100644\n--- a/sklearn/utils/estimator_checks.py\n+++ b/sklearn/utils/estimator_checks.py\n@@ -4438,7 +4438,6 @@ def check_valid_tag_types(name, estimator):\n \n     if tags.regressor_tags is not None:\n         assert isinstance(tags.regressor_tags.poor_score, bool), err_msg\n-        assert isinstance(tags.regressor_tags.multi_label, bool), err_msg\n \n     if tags.transformer_tags is not None:\n         assert isinstance(tags.transformer_tags.preserves_dtype, list), err_msg\ndiff --git a/sklearn/utils/tests/test_tags.py b/sklearn/utils/tests/test_tags.py\nindex 86e4e2d7c431e..2ff6878d974fb 100644\n--- a/sklearn/utils/tests/test_tags.py\n+++ b/sklearn/utils/tests/test_tags.py\n@@ -434,7 +434,6 @@ def __sklearn_tags__(self):\n             classifier_tags = None\n             regressor_tags = RegressorTags(\n                 poor_score=True,\n-                multi_label=True,\n             )\n             return Tags(\n                 estimator_type=self._estimator_type,\n@@ -452,7 +451,7 @@ def __sklearn_tags__(self):\n         \"allow_nan\": True,\n         \"array_api_support\": False,\n         \"binary_only\": False,\n-        \"multilabel\": True,\n+        \"multilabel\": False,\n         \"multioutput\": True,\n         \"multioutput_only\": True,\n         \"no_validation\": False,\n",
  "fail_to_pass": [],
  "pass_to_pass": [],
  "relevant_files": [
    "sklearn/ensemble/_forest.py",
    "sklearn/utils/_tags.py",
    "sklearn/utils/estimator_checks.py",
    "sklearn/utils/tests/test_tags.py"
  ],
  "difficulty": "hard",
  "created_at": "2024-11-29T14:34:54Z",
  "pr_url": "https://github.com/scikit-learn/scikit-learn/pull/30373",
  "issue_url": "https://github.com/scikit-learn/scikit-learn/pull/29677"
}